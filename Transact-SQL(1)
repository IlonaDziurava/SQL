USE Склад4_308
 GO

SELECT * 
 FROM Клиент 
 WHERE (ФИОРуководителя LIKE '%гор%') AND (КодРегиона NOT IN (101, 200) OR КодРегиона IS NULL)

 SELECT * 
 FROM Поставщик 
 WHERE УсловияОплаты != 'Предоплата' OR (КодРегиона < 101 AND КодРегиона > 200 AND КодРегиона < 301 AND КодРегиона > 400)

 SELECT * 
 FROM Регион 
 WHERE (Страна = 'Беларусь' AND Город != 'Минск' AND Город != 'Гомель') OR (Страна = 'Россия' AND Город != 'Москва')

 SELECT * 
 FROM Товар 
 WHERE (КодВалюты = 'USD' AND Цена BETWEEN 200 AND 800) OR (КодВалюты = 'EUR' AND (Цена BETWEEN 100 AND 500 OR Цена IS NULL))

 SELECT * 
 FROM Запрос1
 WHERE (Наименование LIKE '%тер%' OR Наименование LIKE '%тор%' OR Наименование LIKE '%а') AND (Количество IN (5, 10) OR ЕдиницаИзм = 'штука' OR ЕдиницаИзм = 'литр')

 SELECT Клиент.ИмяКлиента, Поставщик.ИмяПоставщика, Товар.Наименование,
   Заказ.КодКлиента, Заказ.КодТовара, Заказ.КодПоставщика
 FROM Заказ
   INNER JOIN Клиент ON Заказ.КодКлиента = Клиент.КодКлиента
   INNER JOIN Поставщик ON Заказ.КодПоставщика = Поставщик.КодПоставщика  
   INNER JOIN Товар ON Заказ.КодТовара = Товар.КодТовара 
 WHERE Заказ.Количество IS NULL OR Заказ.Количество NOT IN (2, 20)

 SELECT Клиент.ИмяКлиента, Товар.Наименование,
   Заказ.КодКлиента, Заказ.КодТовара
 FROM Заказ
   INNER JOIN Клиент ON Заказ.КодКлиента = Клиент.КодКлиента
   INNER JOIN Поставщик ON Заказ.КодПоставщика = Поставщик.КодПоставщика
   INNER JOIN Регион ON Поставщик.КодРегиона = Регион.КодРегиона  
   INNER JOIN Товар ON Заказ.КодТовара = Товар.КодТовара 
 WHERE (Регион.Страна = 'Россия' OR Регион.Страна = 'Беларусь') AND (Заказ.ДатаЗаказа = Заказ.ДатаЗаказа + 45)

 UPDATE Клиент
 SET ИмяКлиента = 'ГП "Верас-М"' 
 WHERE ИмяКлиента = 'ГП ”Верас”' 

 UPDATE Клиент
 SET ФИОРуководителя = NULL 
 WHERE ИмяКлиента = 'ГП "Верас-М"'

 UPDATE Поставщик
 SET УсловияОплаты = 'По договору поставки'
 WHERE (ИмяПоставщика LIKE '%н' OR ИмяПоставщика LIKE '%т' OR ИмяПоставщика LIKE '%л') AND (ИмяПоставщика LIKE 'ЗАО%' OR ИмяПоставщика LIKE 'ОАО%')

 UPDATE Товар 
 SET КодВалюты = 'RUR' 
 WHERE Цена IN (100000, 1000000)

  UPDATE Товар 
 SET Цена = Цена/285 
 WHERE Цена IN (100000, 1000000)

  UPDATE Товар 
 SET КодВалюты = 'USD' 
 WHERE Цена > 1000000

 UPDATE Товар 
 SET Цена = Цена/9100 
 WHERE Цена > 1000000

 UPDATE Заказ  
 SET Заказ.СрокПоставки = Заказ.ДатаЗаказа + 14
 WHERE Заказ.ДатаЗаказа < '15.10.2022'

 UPDATE Заказ  
 SET Заказ.СрокПоставки = Заказ.ДатаЗаказа + 10
 WHERE Заказ.ДатаЗаказа > '15.10.2022'

  UPDATE Заказ  
 SET Заказ.СрокПоставки = Заказ.ДатаЗаказа + 20
 WHERE Заказ.КодПоставщика IS NULL

 INSERT INTO Валюта 
 VALUES ('GRV', 'Украинские гривны', 0.01 , 250)

 INSERT INTO Товар 
 VALUES (666, 'ПК-клавиатура', 'штука', 2630, 'GRV', 'Да')

 INSERT INTO Товар 
 VALUES (777, 'Разъем USB', 'штука', 135, 'GRV', 'Да')

 INSERT INTO Товар 
 VALUES (888, 'Принтер Lexmark', 'штука', 12790, 'GRV', 'Да')

 INSERT INTO Заказ (КодКлиента, КодТовара, Количество, КодПоставщика)
 VALUES (4, 666, 17, 345)

 INSERT INTO Заказ (КодКлиента, КодТовара, Количество, КодПоставщика)
 VALUES (5, 777, 5, 234)

 INSERT INTO Заказ (КодКлиента, КодТовара, Количество, КодПоставщика)
 VALUES (3, 888, 14, 456)

 INSERT INTO Заказ (КодКлиента, КодТовара, Количество, КодПоставщика)
 VALUES (5, 666, 9, 345)

ALTER TABLE Товар DROP CONSTRAINT  FK_Товар_Валюта

DELETE FROM Валюта
 WHERE КодВалюты = 'GRV' 
 GO

 EXEC sp_fkeys 'Регион'
 GO

 ALTER TABLE Клиент DROP CONSTRAINT FK_Клиент_Регион		-- первая команда
 ALTER TABLE Поставщик DROP CONSTRAINT FK_Поставщик_Регион
 DROP TABLE Регион     							-- вторая команда
 GO

EXEC sp_fkeys 'Поставщик'
 GO

ALTER TABLE Заказ DROP CONSTRAINT FK_Заказ_Поставщик
 DROP TABLE Поставщик     							-- вторая команда
 GO
